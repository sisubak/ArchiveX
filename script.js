const clientsData = [
    {
        title: "ae86 client vae5",
        type: "teeworlds cheat",
        badge: "teeworlds • cheat",
        description: "модифицированная версия sash client от русского разработчика с улучшенным функционалом",
        image: "https://i.postimg.cc/L5XYVw5j/Ae86-Client-b-Rsph-Qx-Yd-C.png",
        download: "https://drive.google.com/file/d/1kc2a6ccX0Io4x4Y4pkcFbGn4ihAsufLU/view?usp=sharing",
        arts: [
            "https://i.postimg.cc/TYjz6nvn/image.png",
            "https://i.postimg.cc/kMKZQWGt/image.png",
            "https://i.postimg.cc/MTRsY8WL/image.png",
            "https://i.postimg.cc/Qdt0y78g/image.png"
        ]
    },
    {
        title: "krx client 1.32 crack",
        type: "ddnet",
        badge: "ddnet • cheat • crack",
        description: "кряк крякнутой версия krx клиента 1.32, но не рабочим когом пароль от архива: 1",
        image: "https://i.postimg.cc/25c5w7b1/image.png",
        download: "https://drive.google.com/file/d/1DlHPGvhOozqGMM2PliZKBgY6QtD4jjvU/view?usp=sharing",
        arts: [
            "https://i.postimg.cc/kgb7KB0Q/image.png",
            "https://i.postimg.cc/VNFQWMD5/image.png"
        ]
    },
    {
        title: "ae86 client vae6 beta",
        type: "teeworlds cheat",
        badge: "ddnet • cheat",
        description: "новая бета версия клиента ae86 client",
        image: "https://i.postimg.cc/TPX4yVND/image.png",
        download: "https://drive.google.com/file/d/1d8EPjCQTdrJj4llGI2QUwnim8d97arUk/view?usp=sharing",
        arts: [
            "https://i.postimg.cc/TYjz6nvn/image.png",
            "https://i.postimg.cc/kMKZQWGt/image.png",
            "https://i.postimg.cc/MTRsY8WL/image.png",
            "https://i.postimg.cc/Qdt0y78g/image.png"
        ]
    },
    {
        title: "dd.cff client",
        type: "ddnet cheat",
        badge: "ddnet • cheat",
        description: "мощный клиент для ddnet с отличным чит функционалом",
        image: "https://i.postimg.cc/G2v8F0C2/77CC8FC6-1104-4999-8425-9563957F3F83.png",
        download: "https://drive.google.com/file/d/1LpZuH7zDUTwNF1EQowUntNUQDPUwB4CN/view?usp=drive_link",
        arts: ["https://i.postimg.cc/9FGhQvZy/image.png"]
    },
    {
        title: "goreworlds client",
        type: "teeworlds",
        badge: "teeworlds",
        description: "клиент имеющий 16+ отметку так как имеет кровь и другие вещи",
        image: "https://i.postimg.cc/158VnkLQ/Goreworlds-g27du-XIFXy.png",
        download: "https://drive.google.com/file/d/1yF6pZtd9w4x7-uNlRMlN2sDPLAP7aJgc/view?usp=sharing"
    },
    {
        title: "nn client crack",
        type: "ddnet",
        badge: "ddnet • cheat",
        description: "похож на tclientv3 plus, но улучшенный функционал",
        image: "https://i.postimg.cc/B6gS75VW/image.png",
        download: "https://drive.google.com/file/d/1ckCVIP2HAZPDuPsqcsEWJdcTkOnUMuHk/view?usp=sharing"
    },
    {
        title: "sash upgradev32",
        type: "teeworlds cheat",
        badge: "teeworlds • cheat",
        description: "обновленная версия популярного клиента sash",
        image: "https://i.postimg.cc/9QGYfLgC/DDNet-f-FKHEV6m-BU.png",
        download: "https://drive.google.com/file/d/1dj57EspAJG3SepJtIx33RY4-R7jiSlhm/view?usp=sharing",
        arts: ["https://i.postimg.cc/nrp1YjSJ/image.png"]
    },
    {
        title: "saiko",
        type: "teeworlds cheat",
        badge: "ddnet • cheat",
        description: "tclient, но с avoid freeze функционалом саппорт",
        image: "https://i.postimg.cc/CxpZ956N/image.png",
        download: "https://drive.google.com/file/d/1OBtyT__yH9MmuFxgcddySd5B2I3EfTL3/view?usp=sharing"
    },
    {
        title: "MRXClient",
        type: "ddnet cheat",
        badge: "ddnet • cheat",
        description: "клиентик для тех кто любит не палиться и новайс мапы",
        image: "https://i.postimg.cc/ZRPHGG4q/izobrazenie.png",
        download: "https://drive.google.com/file/d/12gKIkI7XXIhgmpNRsxM9-74HrIx1aT5k/view?usp=sharing"
    },
    {
        title: "Ae86 Client vAe4",
        type: "teeworlds cheat",
        badge: "teeworlds • cheat",
        description: "старая версия Ae86 Client",
        image: "https://i.postimg.cc/q7yW7Zpq/izobrazenie.png",
        download: "https://drive.google.com/file/d/1Q-cdqeR3igj8D1Lm40_OLaOuo43a53Ak/view?usp=drive_link",
        arts: [
            "https://i.postimg.cc/TYjz6nvn/image.png",
            "https://i.postimg.cc/kMKZQWGt/image.png",
            "https://i.postimg.cc/MTRsY8WL/image.png",
            "https://i.postimg.cc/Qdt0y78g/image.png"
        ]
    },
    {
        title: "KoshkaClient",
        type: "ddnet",
        badge: "ddnet",
        description: "легит клиент от создателя KotClient'а",
        image: "https://i.postimg.cc/6QxWbjw5/izobrazenie.png",
        download: "https://drive.google.com/file/d/1I7bUk7DFVcEd8MUL6sCXtgvjmx5Fk_3I/view?usp=sharing"
    },
    {
        title: "Rclient",
        type: "ddnet",
        badge: "ddnet",
        description: "самый ЛУЧШИЙ клиент для легитов, причем без пиздижа. Имеет буквально ВСЕ функции",
        image: "https://i.postimg.cc/xTcHF6zq/izobrazenie.png",
        download: "https://drive.google.com/file/d/1WQ6sPMOkWduOunJ5D0iIkOLusapOmBA4/view?usp=sharing"
    },
    {
        title: "E>client",
        type: "ddnet",
        badge: "ddnet",
        description: "легит клиент, подойдет для тех кому не нравится чем-то Rclient",
        image: "https://i.postimg.cc/vB4gSB1R/izobrazenie.png",
        download: "https://drive.google.com/file/d/1WHAjrSdDI3hfBftzrFFzeA0HF6Az2v5C/view?usp=sharing"
    },
    {
        title: "soup",
        type: "teeworlds cheat",
        badge: "ddnet • cheat",
        description: "копирка saiko, но с более улучшенным авойдом. Подойдет для легитов",
        image: "https://i.postimg.cc/fyHYYktn/izobrazenie.png",
        download: "https://drive.google.com/file/d/1m4_s9OnHBNlhoYIaKygvQutLbbKy3ucS/view?usp=sharing",
        discord: "https://discord.gg/ECeDVAEVJn"
    },
    {
        title: "sakura client",
        type: "ddnet",
        badge: "ddnet",
        description: "элегантный клиент с уникальным дизайном",
        image: "https://i.postimg.cc/YCT1ndNg/DDNet-Nvq-Le-PTl3l.png",
        download: "https://drive.google.com/file/d/1dAN7qLy7EBhL5fpjM2Q3dgUNOO-o7bYl/view?usp=sharing"
    },
    {
        title: "sash by akrd1337",
        type: "teeworlds cheat",
        badge: "teeworlds • cheat",
        description: "модифицированная версия sash клиента",
        image: "https://i.postimg.cc/RF0yrWQr/Sash-crack-9-Bk-Px-GRpz-A.png",
        download: "https://drive.google.com/file/d/1TZLt4QWUcG5BXxzw4_BLi4f6yJMbs3hQ/view?usp=sharing",
        arts: ["https://i.postimg.cc/nrp1YjSJ/image.png"]
    },
    {
        title: "ChillerBot Client",
        type: "teeworlds",
        badge: "teeworlds",
        description: "xz xyeta kakayota<3",
        image: "https://i.postimg.cc/GtSjQTWk/izobrazenie.png",
        download: "https://drive.google.com/drive/folders/1BEnkumBWMuws3Qy2k6rD27WSynLsFj-6?usp=sharing"
    },
    {
        title: "PPDDNet Client",
        type: "ddnet",
        badge: "ddnet",
        description: "создатель веба не смог запустить этот клиент...",
        image: "https://i.postimg.cc/NjVjcGcf/izobrazenie.png",
        download: "https://drive.google.com/drive/folders/1Vt951yPEZR83FyrLcGw9HJiZDw76t9ws?usp=sharing"
    },
    {
        title: "jimjam client",
        type: "teeworlds",
        badge: "teeworlds",
        description: "прикольный клиент, в нем есть много разных полезных функций",
        image: "https://i.postimg.cc/HWZ7LYvz/jimjam.png",
        download: "https://drive.google.com/file/d/1_o3R3FQs3Jv3ARDJKz2EslMxJLbZPJZG/view?usp=sharing"
    },
    {
        title: "k-client",
        type: "teeworlds cheat",
        badge: "teeworlds • cheat",
        description: "клиент похожий на krx, но на teeworlds",
        image: "https://i.postimg.cc/HxtXzb21/K-Client-ENFC6b2kks.png",
        download: "https://drive.google.com/file/d/1CknKAMSTwWoU3OlPwMacin0mqfAaBiRY/view?usp=sharing"
    },
    {
        title: "mario client",
        type: "teeworlds",
        badge: "teeworlds",
        description: "тематический клиент с одной функции которая добавляет визуального mario на сервер",
        image: "https://i.postimg.cc/qMqych6W/mario.png",
        download: "https://drive.google.com/file/d/1wrDlSev7R_3c33wP87tXaFD2dLireEL-/view?usp=sharing"
    },
    {
        title: "dperx",
        type: "ddnet",
        badge: "ddnet • cheat",
        description: "не совсем клиент. Инжектиться в сам дднет и добавляет чит через него",
        image: "https://i.postimg.cc/yNZq5Z7K/izobrazenie.png",
        download: "https://github.com/kiocode/DPerX-Reborn/releases/download/1.1.4/dperx-reborn-1.1.4-setup.exe"
    },
    {
        title: "pulse client",
        type: "ddnet",
        badge: "ddnet",
        description: "новый клиент сильно вдохновленный cactus client'ом",
        image: "https://i.postimg.cc/Pf218zJm/pulse-client.png",
        download: "https://drive.google.com/file/d/100huDXqIS2xmbM1vxAi3YCM_UjxInq8l/view?usp=sharing"
    },
    {
        title: "s-client",
        type: "teeworlds",
        badge: "teeworlds",
        description: "клиент похожий на tclient, но на teewoorlds",
        image: "https://i.postimg.cc/d3HdPvpW/S-Client-Ys-E8k9f-B1w.png",
        download: "https://drive.google.com/file/d/1bUL49r3GTPZInQUZx-fr_WtNmaEanUU4/view?usp=sharing"
    },
    {
        title: "sqclient",
        type: "ddnet cheat",
        badge: "ddnet • cheat",
        description: "новый чит клиент, а точнее его крякнутая версия модификация tclient, но с читами",
        image: "https://i.postimg.cc/vZ6njJzz/SQClient.png",
        download: "https://drive.google.com/file/d/1nAvrsid6ZItkiCzBzBcDToCNjskj5pnC/view?usp=sharing"
    },
    {
        title: "sta client",
        type: "teeworlds cheat",
        badge: "teeworlds • cheat",
        description: "стабильный клиент с расширенным функционалом созданный модератором ddnet",
        image: "https://i.postimg.cc/W4Gkp0xq/Sta.png",
        download: "https://drive.google.com/file/d/1aL4HRDIPJvvzsQ0IaFM03ymjDmUCvdCJ/view?usp=sharing"
    },
    {
        title: "tclientv3+",
        type: "ddnet cheat",
        badge: "ddnet • cheat",
        description: "старая версия популярного tclient, но с чит функционалом",
        image: "https://i.postimg.cc/7L8zyKty/Tclient-Plus.png",
        download: "https://drive.google.com/file/d/1Z019ZmXcA936aFyiz3Qv65Mx8lYpm_NP/view?usp=sharing",
        arts: ["https://i.postimg.cc/Z5CxchH8/image.png"]
    },
    {
        title: "vbot client",
        type: "teeworlds cheat",
        badge: "teeworlds • cheat",
        description: "чит клиент имеющий бота",
        image: "https://i.postimg.cc/LXmZJnMC/vbot.png",
        download: "https://drive.google.com/file/d/1wyWOSwKvVmb7XYczlA_s9tcBpzsFHspm/view?usp=sharing"
    },
    {
        title: "zyro client",
        type: "ddnet cheat",
        badge: "ddnet • cheat",
        description: "чит клиент, создан для не большой помощи разработчикам в создании новых клиентов",
        image: "https://i.postimg.cc/9M1wZCmW/zyro.png",
        download: "https://drive.google.com/file/d/19rqXCnSE3A1t8-qOwJrn-MB7UedwzrdS/view?usp=sharing"
    },
    {
        title: "cactus client",
        type: "ddnet",
        badge: "ddnet",
        description: "почти такой же клиент как и tclient, но создан на русском языке",
        image: "https://i.postimg.cc/6pdSr5SJ/DDNet-0-FDBKfkq-Sp.png",
        download: "https://drive.google.com/file/d/1T7T110zIphf9PGiXL-5e0H5TWM6SrP6x/view?usp=sharing",
        arts: ["https://i.postimg.cc/J0rbBwtN/image.png"]
    },
    {
        title: "cactus client private",
        type: "ddnet",
        badge: "ddnet",
        description: "тот же cactus client, но крякнутая приватная версия",
        image: "https://i.postimg.cc/W1j9TM9Y/image.png",
        download: "https://drive.google.com/file/d/1SyKu6KNSZIDOl_Psex72ydLy8GrWt4f6/view?usp=sharing",
        arts: ["https://i.postimg.cc/J0rbBwtN/image.png"]
    },
    {
        title: "tater client",
        type: "ddnet",
        badge: "ddnet",
        description: "модификация ddnet клиента со своим визуальным функционалом",
        image: "https://i.postimg.cc/L53Dqn5N/DDNet-Kkrd-PXJh-TN.png",
        download: "https://drive.google.com/file/d/1Edpb1pXB6_WngDM1XhqiGJL4bDGKJ85T/view?usp=sharing",
        arts: ["https://i.postimg.cc/Z5CxchH8/image.png"]
    }
];


let currentGallery = []
let currentGalleryIndex = 0

const debounce = (fn, wait) => {
    let timeout
    return (...args) => {
        clearTimeout(timeout)
        timeout = setTimeout(() => fn(...args), wait)
    }
}

function renderClients() {
    const grid = document.getElementById('clientsGrid')
    if (!grid) return
    const frag = document.createDocumentFragment()
    clientsData.forEach((client, i) => {
        const card = document.createElement('div')
        card.className = 'client-card'
        card.setAttribute('data-type', client.type)
        let artBtn = ''
        if (client.arts && client.arts.length > 0) {
            artBtn = `<button class="card-btn art" onclick="openArtGallery(${i})"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>Arts</button>`
        }
        let discordBtn = ''
        if (client.discord) {
            discordBtn = `<a href="${client.discord}" class="card-btn outline" target="_blank"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M20.317 4.37a19.79 19.79 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.74 19.74 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.08.08 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.11 13.11 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.3 12.3 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.84 19.84 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.06.06 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"/></svg>Discord</a>`
        }
        let telegramBtn = ''
        if (client.telegram) {
            telegramBtn = `<a href="${client.telegram}" class="card-btn outline" target="_blank"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/></svg>Telegram</a>`
        }
        let downloadBtn = ''
        if (client.download) {
            downloadBtn = `<a href="${client.download}" class="card-btn" target="_blank"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>Download</a>`
        } else if (client.buy) {
            downloadBtn = `<a href="${client.buy}" class="card-btn" target="_blank"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>Buy</a>`
        }
        card.innerHTML = `<div class="card-img"><img src="${client.image}" alt="${client.title}" loading="lazy"><span class="card-badge">${client.badge}</span></div><div class="card-body"><h3 class="card-title">${client.title}</h3><p class="card-desc">${client.description}</p><div class="card-buttons"><button class="card-btn outline" onclick="openImageModal('${client.image}')"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>Preview</button>${artBtn}${discordBtn}${telegramBtn}${downloadBtn}</div></div>`
        frag.appendChild(card)
    })
    grid.innerHTML = ''
    grid.appendChild(frag)
}

const flipWords = document.querySelectorAll('.flip-word')
let flipIndex = 0

function flipWord() {
    const current = flipWords[flipIndex]
    current.classList.remove('active')
    current.classList.add('exit-up')
    flipIndex = (flipIndex + 1) % flipWords.length
    const next = flipWords[flipIndex]
    next.classList.remove('exit-up')
    next.classList.add('enter-down')
    requestAnimationFrame(() => {
        requestAnimationFrame(() => {
            next.classList.remove('enter-down')
            next.classList.add('active')
        })
    })
    setTimeout(() => {
        current.classList.remove('exit-up')
    }, 600)
}

setInterval(flipWord, 2500)

window.addEventListener('scroll', debounce(() => {
    const header = document.getElementById('header')
    const scrollTop = document.getElementById('scrollTop')
    if (window.scrollY > 50) {
        header.classList.add('scrolled')
    } else {
        header.classList.remove('scrolled')
    }
    if (window.scrollY > 500) {
        scrollTop.classList.add('visible')
    } else {
        scrollTop.classList.remove('visible')
    }
}, 10))

const menuToggle = document.getElementById('menuToggle')
const navMenu = document.getElementById('navMenu')

menuToggle.addEventListener('click', () => {
    menuToggle.classList.toggle('active')
    navMenu.classList.toggle('active')
})

document.querySelectorAll('a[href^="#"]').forEach(a => {
    a.addEventListener('click', e => {
        e.preventDefault()
        const target = document.querySelector(a.getAttribute('href'))
        if (target) {
            const offset = 80
            window.scrollTo({
                top: target.offsetTop - offset,
                behavior: 'smooth'
            })
            navMenu.classList.remove('active')
            menuToggle.classList.remove('active')
        }
    })
})

document.getElementById('scrollTop').addEventListener('click', () => {
    window.scrollTo({ top: 0, behavior: 'smooth' })
})

const searchInput = document.getElementById('searchInput')
searchInput.addEventListener('input', debounce(e => {
    const term = e.target.value.toLowerCase()
    document.querySelectorAll('.client-card').forEach(card => {
        const title = card.querySelector('.card-title').textContent.toLowerCase()
        const desc = card.querySelector('.card-desc').textContent.toLowerCase()
        if (title.includes(term) || desc.includes(term)) {
            card.classList.remove('hidden')
        } else {
            card.classList.add('hidden')
        }
    })
}, 300))

document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'))
        btn.classList.add('active')
        const filter = btn.dataset.filter
        document.querySelectorAll('.client-card').forEach(card => {
            if (filter === 'all') {
                card.classList.remove('hidden')
            } else {
                const types = card.dataset.type
                if (types && types.includes(filter)) {
                    card.classList.remove('hidden')
                } else {
                    card.classList.add('hidden')
                }
            }
        })
    })
})

function openImageModal(src) {
    const modal = document.getElementById('imageModal')
    const img = document.getElementById('modalImage')
    img.src = src
    modal.classList.add('active')
    document.body.style.overflow = 'hidden'
}

function closeImageModal() {
    document.getElementById('imageModal').classList.remove('active')
    document.body.style.overflow = ''
}

window.openImageModal = openImageModal

document.getElementById('modalClose').addEventListener('click', closeImageModal)
document.getElementById('imageModal').addEventListener('click', e => {
    if (e.target === e.currentTarget) closeImageModal()
})

function openArtGallery(index) {
    const client = clientsData[index]
    if (!client.arts || !client.arts.length) return
    currentGallery = client.arts
    currentGalleryIndex = 0
    const gallery = document.getElementById('artGallery')
    const img = document.getElementById('galleryImage')
    const dots = document.getElementById('galleryDots')
    img.src = currentGallery[0]
    dots.innerHTML = ''
    currentGallery.forEach((_, i) => {
        const dot = document.createElement('div')
        dot.className = 'gallery-dot' + (i === 0 ? ' active' : '')
        dot.addEventListener('click', () => goToImage(i))
        dots.appendChild(dot)
    })
    updateCounter()
    gallery.classList.add('active')
    document.body.style.overflow = 'hidden'
}

function goToImage(i) {
    currentGalleryIndex = i
    document.getElementById('galleryImage').src = currentGallery[i]
    document.querySelectorAll('.gallery-dot').forEach((d, idx) => d.classList.toggle('active', idx === i))
    updateCounter()
}

function updateCounter() {
    document.getElementById('galleryCount').textContent = `${currentGalleryIndex + 1} / ${currentGallery.length}`
}

function closeGallery() {
    document.getElementById('artGallery').classList.remove('active')
    document.body.style.overflow = ''
}

window.openArtGallery = openArtGallery

document.getElementById('galleryClose').addEventListener('click', closeGallery)
document.getElementById('galleryPrev').addEventListener('click', () => goToImage((currentGalleryIndex - 1 + currentGallery.length) % currentGallery.length))
document.getElementById('galleryNext').addEventListener('click', () => goToImage((currentGalleryIndex + 1) % currentGallery.length))
document.getElementById('artGallery').addEventListener('click', e => {
    if (e.target === e.currentTarget) closeGallery()
})

document.addEventListener('keydown', e => {
    if (e.key === 'Escape') {
        closeImageModal()
        closeGallery()
    }
    if (document.getElementById('artGallery').classList.contains('active')) {
        if (e.key === 'ArrowRight') goToImage((currentGalleryIndex + 1) % currentGallery.length)
        if (e.key === 'ArrowLeft') goToImage((currentGalleryIndex - 1 + currentGallery.length) % currentGallery.length)
    }
})

const statValues = document.querySelectorAll('.stat-value')
let animated = false

const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
        if (entry.isIntersecting && !animated) {
            animated = true
            statValues.forEach(el => {
                const target = parseInt(el.dataset.count)
                let current = 0
                const duration = 2000
                const increment = target / (duration / 16)
                const update = () => {
                    current += increment
                    if (current < target) {
                        el.textContent = Math.floor(current)
                        requestAnimationFrame(update)
                    } else {
                        el.textContent = target
                    }
                }
                update()
            })
            observer.unobserve(entry.target)
        }
    })
}, { threshold: 0.3 })

observer.observe(document.getElementById('stats'))

document.querySelectorAll('.feature-card').forEach(card => {
    card.addEventListener('mousemove', e => {
        const rect = card.getBoundingClientRect()
        const x = e.clientX - rect.left
        const y = e.clientY - rect.top
        card.style.setProperty('--mouse-x', `${x}px`)
        card.style.setProperty('--mouse-y', `${y}px`)
    })
})

window.addEventListener('load', renderClients)
